<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="de"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>OdfOfficeMeta.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ODFDOM</a> &gt; <a href="index.source.html" class="el_package">org.odftoolkit.odfdom.incubator.meta</a> &gt; <span class="el_source">OdfOfficeMeta.java</span></div><h1>OdfOfficeMeta.java</h1><pre class="source lang-java linenums">/**
 * **********************************************************************
 *
 * &lt;p&gt;DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER
 *
 * &lt;p&gt;Copyright 2008, 2010 Oracle and/or its affiliates. All rights reserved.
 *
 * &lt;p&gt;Use is subject to license terms.
 *
 * &lt;p&gt;Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file
 * except in compliance with the License. You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0. You can also obtain a copy of the License at
 * http://odftoolkit.org/docs/license.txt
 *
 * &lt;p&gt;Unless required by applicable law or agreed to in writing, software distributed under the
 * License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied.
 *
 * &lt;p&gt;See the License for the specific language governing permissions and limitations under the
 * License.
 *
 * &lt;p&gt;**********************************************************************
 */
package org.odftoolkit.odfdom.incubator.meta;

import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.List;
import org.odftoolkit.odfdom.dom.element.dc.DcCreatorElement;
import org.odftoolkit.odfdom.dom.element.dc.DcDateElement;
import org.odftoolkit.odfdom.dom.element.dc.DcDescriptionElement;
import org.odftoolkit.odfdom.dom.element.dc.DcLanguageElement;
import org.odftoolkit.odfdom.dom.element.dc.DcSubjectElement;
import org.odftoolkit.odfdom.dom.element.dc.DcTitleElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaAutoReloadElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaCreationDateElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaDocumentStatisticElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaEditingCyclesElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaEditingDurationElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaGeneratorElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaHyperlinkBehaviourElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaInitialCreatorElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaKeywordElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaPrintDateElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaPrintedByElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaTemplateElement;
import org.odftoolkit.odfdom.dom.element.meta.MetaUserDefinedElement;
import org.odftoolkit.odfdom.dom.element.office.OfficeDocumentMetaElement;
import org.odftoolkit.odfdom.dom.element.office.OfficeMetaElement;
import org.odftoolkit.odfdom.pkg.OdfElement;
import org.odftoolkit.odfdom.pkg.OdfFileDom;
import org.odftoolkit.odfdom.type.Duration;

/**
 * &lt;code&gt;OdfOfficeMeta&lt;/code&gt; represent the meta data feature in the ODF document.
 *
 * &lt;p&gt;It provides convenient method to get meta data info.
 */
public class OdfOfficeMeta {

  private OfficeMetaElement mOfficeMetaElement;
<span class="fc" id="L64">  private boolean mAutomaticUpdate = true;</span>

  /**
   * Constructor of &lt;code&gt;OdfOfficeMeta&lt;/code&gt; feature.
   *
   * @param metaDom the file DOM element of meta.xml
   */
<span class="fc" id="L71">  public OdfOfficeMeta(OdfFileDom metaDom) {</span>
<span class="fc" id="L72">    OfficeDocumentMetaElement metaEle =</span>
<span class="fc" id="L73">        OdfElement.findFirstChildNode(OfficeDocumentMetaElement.class, metaDom);</span>
<span class="fc" id="L74">    mOfficeMetaElement = OdfElement.findFirstChildNode(OfficeMetaElement.class, metaEle);</span>
<span class="fc" id="L75">  }</span>

  /**
   * Get the instance of &lt;code&gt;OfficeMetaElement&lt;/code&gt; which represents this feature.
   *
   * @return the instance of OfficeMetaElement
   */
  public OfficeMetaElement getOfficeMetaElement() {
<span class="fc" id="L83">    return mOfficeMetaElement;</span>
  }

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;MetaGeneratorElement&lt;/code&gt; , See
   * {@odf.element meta:generator}.
   *
   * @return the generator info of the current document;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public String getGenerator() {
<span class="fc" id="L94">    MetaGeneratorElement metaGenerator =</span>
<span class="fc" id="L95">        OdfElement.findFirstChildNode(MetaGeneratorElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L96" title="1 of 2 branches missed.">    if (metaGenerator != null) {</span>
<span class="fc" id="L97">      return metaGenerator.getTextContent();</span>
    }
<span class="nc" id="L99">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;MetaGeneratorElement&lt;/code&gt; , See
   * {@odf.element meta:generator}.
   *
   * @param generator set the specified document generator. NULL will remove the element from the
   *     meta.xml.
   */
  public void setGenerator(String generator) {
<span class="fc" id="L110">    MetaGeneratorElement metaGeneratorEle =</span>
<span class="fc" id="L111">        OdfElement.findFirstChildNode(MetaGeneratorElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L112" title="1 of 2 branches missed.">    if (generator == null) {</span>
<span class="nc bnc" id="L113" title="All 2 branches missed.">      if (metaGeneratorEle != null) {</span>
<span class="nc" id="L114">        mOfficeMetaElement.removeChild(metaGeneratorEle);</span>
      }
    } else {
<span class="fc bfc" id="L117" title="All 2 branches covered.">      if (metaGeneratorEle == null) {</span>
<span class="fc" id="L118">        metaGeneratorEle = mOfficeMetaElement.newMetaGeneratorElement();</span>
      }
<span class="fc" id="L120">      metaGeneratorEle.setTextContent(generator);</span>
    }
<span class="fc" id="L122">  }</span>

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;DcTitleElement&lt;/code&gt; , See
   * {@odf.element dc:title}.
   *
   * @return the title of the current document;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public String getTitle() {

<span class="fc" id="L133">    DcTitleElement titleEle =</span>
<span class="fc" id="L134">        OdfElement.findFirstChildNode(DcTitleElement.class, mOfficeMetaElement);</span>
<span class="fc bfc" id="L135" title="All 2 branches covered.">    if (titleEle != null) {</span>
<span class="fc" id="L136">      return titleEle.getTextContent();</span>
    }
<span class="fc" id="L138">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;DcTitleElement&lt;/code&gt; , See
   * {@odf.element dc:title}.
   *
   * @param title set the specified document title. NULL will remove the element from the meta.xml.
   */
  public void setTitle(String title) {
<span class="fc" id="L148">    DcTitleElement titleEle =</span>
<span class="fc" id="L149">        OdfElement.findFirstChildNode(DcTitleElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L150" title="1 of 2 branches missed.">    if (title == null) {</span>
<span class="nc bnc" id="L151" title="All 2 branches missed.">      if (titleEle != null) {</span>
<span class="nc" id="L152">        mOfficeMetaElement.removeChild(titleEle);</span>
      }
    } else {
<span class="pc bpc" id="L155" title="1 of 2 branches missed.">      if (titleEle == null) {</span>
<span class="nc" id="L156">        titleEle = mOfficeMetaElement.newDcTitleElement();</span>
      }
<span class="fc" id="L158">      titleEle.setTextContent(title);</span>
    }
<span class="fc" id="L160">  }</span>

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;DcDescriptionElement&lt;/code&gt; , See
   * {@odf.element dc:description}.
   *
   * @return the description of the current document;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public String getDescription() {
<span class="fc" id="L170">    DcDescriptionElement descEle =</span>
<span class="fc" id="L171">        OdfElement.findFirstChildNode(DcDescriptionElement.class, mOfficeMetaElement);</span>
<span class="fc bfc" id="L172" title="All 2 branches covered.">    if (descEle != null) {</span>
<span class="fc" id="L173">      return descEle.getTextContent();</span>
    }
<span class="fc" id="L175">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;DcDescriptionElement&lt;/code&gt; , See
   * {@odf.element dc:description}.
   *
   * @param description set the specified document description. NULL will remove the element from
   *     the meta.xml.
   */
  public void setDescription(String description) {
<span class="fc" id="L186">    DcDescriptionElement descEle =</span>
<span class="fc" id="L187">        OdfElement.findFirstChildNode(DcDescriptionElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L188" title="1 of 2 branches missed.">    if (description == null) {</span>
<span class="nc bnc" id="L189" title="All 2 branches missed.">      if (descEle != null) {</span>
<span class="nc" id="L190">        mOfficeMetaElement.removeChild(descEle);</span>
      }
    } else {
<span class="pc bpc" id="L193" title="1 of 2 branches missed.">      if (descEle == null) {</span>
<span class="nc" id="L194">        descEle = mOfficeMetaElement.newDcDescriptionElement();</span>
      }
<span class="fc" id="L196">      descEle.setTextContent(description);</span>
    }
<span class="fc" id="L198">  }</span>

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;DcSubjectElement&lt;/code&gt; , See
   * {@odf.element dc:subject}.
   *
   * @return the subject of the current document;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public String getSubject() {
<span class="fc" id="L208">    DcSubjectElement subjectEle =</span>
<span class="fc" id="L209">        OdfElement.findFirstChildNode(DcSubjectElement.class, mOfficeMetaElement);</span>
<span class="fc bfc" id="L210" title="All 2 branches covered.">    if (subjectEle != null) {</span>
<span class="fc" id="L211">      return subjectEle.getTextContent();</span>
    }
<span class="fc" id="L213">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;DcSubjectElement&lt;/code&gt; , See
   * {@odf.element dc:subject}.
   *
   * @param subject set the specified document subject. NULL will remove the element from the
   *     meta.xml.
   */
  public void setSubject(String subject) {
<span class="fc" id="L224">    DcSubjectElement subjectEle =</span>
<span class="fc" id="L225">        OdfElement.findFirstChildNode(DcSubjectElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L226" title="1 of 2 branches missed.">    if (subject == null) {</span>
<span class="nc bnc" id="L227" title="All 2 branches missed.">      if (subjectEle != null) {</span>
<span class="nc" id="L228">        mOfficeMetaElement.removeChild(subjectEle);</span>
      }
    } else {
<span class="pc bpc" id="L231" title="1 of 2 branches missed.">      if (subjectEle == null) {</span>
<span class="nc" id="L232">        subjectEle = mOfficeMetaElement.newDcSubjectElement();</span>
      }
<span class="fc" id="L234">      subjectEle.setTextContent(subject);</span>
    }
<span class="fc" id="L236">  }</span>

  /**
   * Receives the list value of the ODFDOM element representation &lt;code&gt;MetaKeywordElement&lt;/code&gt; ,
   * See {@odf.element meta:keyword}.
   *
   * @return the keywords of the current document;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public List&lt;String&gt; getKeywords() {
<span class="fc" id="L246">    List&lt;String&gt; keywords = new ArrayList&lt;String&gt;();</span>
<span class="fc" id="L247">    MetaKeywordElement keywordEle =</span>
<span class="fc" id="L248">        OdfElement.findFirstChildNode(MetaKeywordElement.class, mOfficeMetaElement);</span>
<span class="fc bfc" id="L249" title="All 2 branches covered.">    if (keywordEle != null) {</span>
<span class="fc" id="L250">      keywords.add(keywordEle.getTextContent());</span>
      MetaKeywordElement keywordNext;
<span class="fc bfc" id="L252" title="All 2 branches covered.">      while ((keywordNext = OdfElement.findNextChildNode(MetaKeywordElement.class, keywordEle))</span>
          != null) {
<span class="fc" id="L254">        keywords.add(keywordNext.getTextContent());</span>
<span class="fc" id="L255">        keywordEle = keywordNext;</span>
      }
<span class="fc" id="L257">      return keywords;</span>
    } else {
<span class="fc" id="L259">      return null;</span>
    }
  }

  /**
   * Sets the list value of the ODFDOM element representation &lt;code&gt;MetaKeywordElement&lt;/code&gt; , See
   * {@odf.element meta:keyword}.
   *
   * @param keyList set the specified list of keywords
   */
  public void setKeywords(List&lt;String&gt; keyList) {
<span class="fc" id="L270">    MetaKeywordElement keywordEle =</span>
<span class="fc" id="L271">        OdfElement.findFirstChildNode(MetaKeywordElement.class, mOfficeMetaElement);</span>
<span class="fc" id="L272">    List&lt;MetaKeywordElement&gt; toBeDeleted = new ArrayList&lt;MetaKeywordElement&gt;();</span>
<span class="fc bfc" id="L273" title="All 2 branches covered.">    if (keywordEle != null) {</span>
      MetaKeywordElement keywordTmp;
<span class="fc" id="L275">      toBeDeleted.add(keywordEle);</span>
<span class="fc bfc" id="L276" title="All 2 branches covered.">      while ((keywordTmp = OdfElement.findNextChildNode(MetaKeywordElement.class, keywordEle))</span>
          != null) {
<span class="fc" id="L278">        keywordEle = keywordTmp;</span>
<span class="fc" id="L279">        toBeDeleted.add(keywordTmp);</span>
      }
    }

    // remove the original
<span class="fc bfc" id="L284" title="All 2 branches covered.">    for (MetaKeywordElement keyele : toBeDeleted) {</span>
<span class="fc" id="L285">      mOfficeMetaElement.removeChild(keyele);</span>
<span class="fc" id="L286">    }</span>
    // add new
<span class="fc bfc" id="L288" title="All 2 branches covered.">    for (int i = 0; i &lt; keyList.size(); i++) {</span>
<span class="fc" id="L289">      MetaKeywordElement keywordElement = mOfficeMetaElement.newMetaKeywordElement();</span>
<span class="fc" id="L290">      keywordElement.setTextContent(keyList.get(i));</span>
    }
<span class="fc" id="L292">  }</span>

  /**
   * Add the keyword to the current document. Create child element {@odf.element meta:keyword}.
   *
   * @param keyword the value of child element {@odf.element meta:keyword}.
   */
  public void addKeyword(String keyword) {
<span class="fc" id="L300">    MetaKeywordElement keywordElement = mOfficeMetaElement.newMetaKeywordElement();</span>
<span class="fc" id="L301">    keywordElement.setTextContent(keyword);</span>
<span class="fc" id="L302">  }</span>

  /**
   * Receives the list value of the ODFDOM element representation &lt;code&gt;MetaUserDefinedElement
   * &lt;/code&gt; , See {@odf.element meta:user-defined}.
   *
   * @return get the list of user-defined metadata names;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public List&lt;String&gt; getUserDefinedDataNames() {
<span class="fc" id="L312">    List&lt;String&gt; definedNames = new ArrayList&lt;String&gt;();</span>
<span class="fc" id="L313">    MetaUserDefinedElement definedEle =</span>
<span class="fc" id="L314">        OdfElement.findFirstChildNode(MetaUserDefinedElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L315" title="1 of 2 branches missed.">    if (definedEle != null) {</span>

<span class="fc" id="L317">      definedNames.add(definedEle.getMetaNameAttribute());</span>
      MetaUserDefinedElement definedNext;
<span class="fc bfc" id="L319" title="All 2 branches covered.">      while ((definedNext = OdfElement.findNextChildNode(MetaUserDefinedElement.class, definedEle))</span>
          != null) {

<span class="fc" id="L322">        definedNames.add(definedNext.getMetaNameAttribute());</span>

<span class="fc" id="L324">        definedEle = definedNext;</span>
      }
<span class="fc" id="L326">      return definedNames;</span>
    } else {
<span class="nc" id="L328">      return null;</span>
    }
  }

  /**
   * Receives the ODFDOM element representation &lt;code&gt;MetaUserDefinedElement&lt;/code&gt; by attribute
   * name, See {@odf.element meta:user-defined}.
   *
   * @param name the name of the user-defined metadata
   * @return the &lt;code&gt;MetaUserDefinedElement&lt;/code&gt; which is identified by the specified name;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public MetaUserDefinedElement getUserDefinedElementByAttributeName(String name) {
<span class="fc" id="L341">    MetaUserDefinedElement definedEle =</span>
<span class="fc" id="L342">        OdfElement.findFirstChildNode(MetaUserDefinedElement.class, mOfficeMetaElement);</span>
<span class="fc bfc" id="L343" title="All 2 branches covered.">    if (definedEle != null) {</span>
<span class="fc bfc" id="L344" title="All 2 branches covered.">      if (definedEle.getMetaNameAttribute().equals(name)) {</span>
<span class="fc" id="L345">        return definedEle;</span>
      }
      MetaUserDefinedElement definedNext;
<span class="fc bfc" id="L348" title="All 2 branches covered.">      while ((definedNext = OdfElement.findNextChildNode(MetaUserDefinedElement.class, definedEle))</span>
          != null) {

<span class="fc bfc" id="L351" title="All 2 branches covered.">        if (definedNext.getMetaNameAttribute().equals(name)) {</span>
<span class="fc" id="L352">          return definedNext;</span>
        }

<span class="fc" id="L355">        definedEle = definedNext;</span>
      }
<span class="fc" id="L357">      return null;</span>
    } else {
<span class="fc" id="L359">      return null;</span>
    }
  }

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;MetaUserDefinedElement&lt;/code&gt; by
   * attribute name, See {@odf.element meta:user-defined}.
   *
   * @param name the name of the user-defined metadata
   * @return the value of the user-defined metadata with the specified name;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public String getUserDefinedDataValue(String name) {
<span class="fc" id="L372">    MetaUserDefinedElement definedElement = getUserDefinedElementByAttributeName(name);</span>
<span class="pc bpc" id="L373" title="1 of 2 branches missed.">    if (definedElement != null) {</span>
<span class="fc" id="L374">      return definedElement.getTextContent();</span>
    }
<span class="nc" id="L376">    return null;</span>
  }

  /**
   * Receives the data type of the ODFDOM element representation &lt;code&gt;MetaUserDefinedElement&lt;/code&gt;
   * by attribute name, See {@odf.element meta:user-defined}.
   *
   * @param name the name of the user-defined metadata
   * @return the data type of the user-defined metadata with the specified name;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public String getUserDefinedDataType(String name) {
<span class="fc" id="L388">    MetaUserDefinedElement definedElement = getUserDefinedElementByAttributeName(name);</span>
<span class="pc bpc" id="L389" title="1 of 2 branches missed.">    if (definedElement != null) {</span>
<span class="fc" id="L390">      return definedElement.getMetaValueTypeAttribute();</span>
    }
<span class="nc" id="L392">    return null;</span>
  }

  /**
   * Remove the ODFDOM element representation &lt;code&gt;MetaUserDefinedElement&lt;/code&gt; by attribute name,
   * See {@odf.element meta:user-defined}.
   *
   * @param name the name of the user-defined metadata
   */
  public void removeUserDefinedDataByName(String name) {
<span class="fc" id="L402">    MetaUserDefinedElement definedElement = getUserDefinedElementByAttributeName(name);</span>
<span class="pc bpc" id="L403" title="1 of 2 branches missed.">    if (definedElement != null) {</span>
<span class="fc" id="L404">      mOfficeMetaElement.removeChild(definedElement);</span>
    }
<span class="fc" id="L406">  }</span>

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;MetaUserDefinedElement&lt;/code&gt; by
   * attribute name, See {@odf.element meta:user-defined}.
   *
   * @param name the name need to set for the user-defined metadata
   * @param value the value need to set for the user-defined metadata
   */
  public void setUserDefinedDataValue(String name, String value) {
<span class="fc" id="L416">    MetaUserDefinedElement definedElement = getUserDefinedElementByAttributeName(name);</span>
<span class="pc bpc" id="L417" title="1 of 2 branches missed.">    if (definedElement != null) {</span>
<span class="fc" id="L418">      definedElement.setTextContent(value);</span>
    }
<span class="fc" id="L420">  }</span>

  /**
   * Sets the data type of the ODFDOM element representation &lt;code&gt;MetaUserDefinedElement&lt;/code&gt; by
   * attribute name, See {@odf.element meta:user-defined}.
   *
   * @param name the name need to set for the user-defined metadata
   * @param value the value need to set for the user-defined metadata
   */
  public void setUserDefinedDataType(String name, String value) {
<span class="fc" id="L430">    MetaUserDefinedElement definedElement = getUserDefinedElementByAttributeName(name);</span>
<span class="pc bpc" id="L431" title="1 of 2 branches missed.">    if (definedElement != null) {</span>
<span class="fc" id="L432">      definedElement.setMetaValueTypeAttribute(value);</span>
    }
<span class="fc" id="L434">  }</span>

  /**
   * Sets the ODFDOM element representation &lt;code&gt;MetaUserDefinedElement&lt;/code&gt; , See {@odf.element
   * meta:user-defined} if the element with the attribute name exists,then update;or create a new
   * element if type or value is null,the original will not be updated.
   *
   * @param name the name need to set for the user-defined metadata
   * @param type the data type need to set for the user-defined metadata
   * @param value the value need to set for the user-defined metadata
   */
  public void setUserDefinedData(String name, String type, String value) {
    // test if name exists
<span class="fc" id="L447">    MetaUserDefinedElement definedElement = getUserDefinedElementByAttributeName(name);</span>
    // if exists, then update,if parameter is null, then don't change
<span class="fc bfc" id="L449" title="All 2 branches covered.">    if (definedElement != null) {</span>
<span class="pc bpc" id="L450" title="1 of 2 branches missed.">      if (type != null) {</span>
<span class="fc" id="L451">        definedElement.setMetaValueTypeAttribute(type);</span>
      }
<span class="pc bpc" id="L453" title="1 of 2 branches missed.">      if (value != null) {</span>
<span class="fc" id="L454">        definedElement.setTextContent(value);</span>
      }
    } else {
      // if not exists, add
<span class="fc" id="L458">      definedElement = mOfficeMetaElement.newMetaUserDefinedElement(name, type);</span>
<span class="fc" id="L459">      definedElement.setTextContent(value);</span>
    }
<span class="fc" id="L461">  }</span>

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;MetaInitialCreatorElement&lt;/code&gt;
   * , See {@odf.element meta:initial-creator}.
   *
   * @return get the initial creator of the current document;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public String getInitialCreator() {
<span class="fc" id="L471">    MetaInitialCreatorElement iniCreatorEle =</span>
<span class="fc" id="L472">        OdfElement.findFirstChildNode(MetaInitialCreatorElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L473" title="1 of 2 branches missed.">    if (iniCreatorEle != null) {</span>
<span class="fc" id="L474">      return iniCreatorEle.getTextContent();</span>
    }
<span class="nc" id="L476">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;MetaInitialCreatorElement&lt;/code&gt; ,
   * See {@odf.element meta:initial-creator}.
   *
   * @param initialCreator set the specified initial creator. NULL will remove the element from the
   *     meta.xml.
   */
  public void setInitialCreator(String initialCreator) {
<span class="fc" id="L487">    MetaInitialCreatorElement initialCreatorEle =</span>
<span class="fc" id="L488">        OdfElement.findFirstChildNode(MetaInitialCreatorElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L489" title="1 of 2 branches missed.">    if (initialCreator == null) {</span>
<span class="nc bnc" id="L490" title="All 2 branches missed.">      if (initialCreatorEle != null) {</span>
<span class="nc" id="L491">        mOfficeMetaElement.removeChild(initialCreatorEle);</span>
      }
    } else {
<span class="pc bpc" id="L494" title="1 of 2 branches missed.">      if (initialCreatorEle == null) {</span>
<span class="nc" id="L495">        initialCreatorEle = mOfficeMetaElement.newMetaInitialCreatorElement();</span>
      }
<span class="fc" id="L497">      initialCreatorEle.setTextContent(initialCreator);</span>
    }
<span class="fc" id="L499">  }</span>

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;DcCreatorElement&lt;/code&gt; , See
   * {@odf.element dc:creator}
   *
   * @return the creator of the current document;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public String getCreator() {
<span class="fc" id="L509">    DcCreatorElement creatorEle =</span>
<span class="fc" id="L510">        OdfElement.findFirstChildNode(DcCreatorElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L511" title="1 of 2 branches missed.">    if (creatorEle != null) {</span>
<span class="fc" id="L512">      return creatorEle.getTextContent();</span>
    }
<span class="nc" id="L514">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;DcCreatorElement&lt;/code&gt; , See
   * {@odf.element dc:creator}.
   *
   * @param creator set the specified creator. NULL will remove the element from the meta.xml.
   */
  public void setCreator(String creator) {
<span class="fc" id="L524">    DcCreatorElement creatorEle =</span>
<span class="fc" id="L525">        OdfElement.findFirstChildNode(DcCreatorElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L526" title="1 of 2 branches missed.">    if (creator == null) {</span>
<span class="nc bnc" id="L527" title="All 2 branches missed.">      if (creatorEle != null) {</span>
<span class="nc" id="L528">        mOfficeMetaElement.removeChild(creatorEle);</span>
      }
    } else {
<span class="pc bpc" id="L531" title="1 of 2 branches missed.">      if (creatorEle == null) {</span>
<span class="nc" id="L532">        creatorEle = mOfficeMetaElement.newDcCreatorElement();</span>
      }
<span class="fc" id="L534">      creatorEle.setTextContent(creator);</span>
    }
<span class="fc" id="L536">  }</span>

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;MetaPrintedByElement&lt;/code&gt; , See
   * {@odf.element meta:printed-by}
   *
   * @return the name of the last person who printed the current document;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if element is not set
   */
  public String getPrintedBy() {
<span class="fc" id="L546">    MetaPrintedByElement printedByEle =</span>
<span class="fc" id="L547">        OdfElement.findFirstChildNode(MetaPrintedByElement.class, mOfficeMetaElement);</span>
<span class="fc bfc" id="L548" title="All 2 branches covered.">    if (printedByEle != null) {</span>
<span class="fc" id="L549">      return printedByEle.getTextContent();</span>
    }
<span class="fc" id="L551">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;MetaPrintedByElement&lt;/code&gt; , See
   * {@odf.element meta:printed-by}.
   *
   * @param printedBy the name need to set for the last person who printed the current document.
   *     NULL will remove the element from the meta.xml.
   */
  public void setPrintedBy(String printedBy) {
<span class="fc" id="L562">    MetaPrintedByElement printedByEle =</span>
<span class="fc" id="L563">        OdfElement.findFirstChildNode(MetaPrintedByElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L564" title="1 of 2 branches missed.">    if (printedBy == null) {</span>
<span class="nc bnc" id="L565" title="All 2 branches missed.">      if (printedByEle != null) {</span>
<span class="nc" id="L566">        mOfficeMetaElement.removeChild(printedByEle);</span>
      }
    } else {
<span class="pc bpc" id="L569" title="1 of 2 branches missed.">      if (printedByEle == null) {</span>
<span class="nc" id="L570">        printedByEle = mOfficeMetaElement.newMetaPrintedByElement();</span>
      }
<span class="fc" id="L572">      printedByEle.setTextContent(printedBy);</span>
    }
<span class="fc" id="L574">  }</span>

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;MetaCreationDateElement&lt;/code&gt; ,
   * See {@odf.element meta:creation-date}
   *
   * @return the date and time when the document was created initially;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if element is not set
   */
  public Calendar getCreationDate() {
<span class="fc" id="L584">    MetaCreationDateElement creationDateEle =</span>
<span class="fc" id="L585">        OdfElement.findFirstChildNode(MetaCreationDateElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L586" title="1 of 2 branches missed.">    if (creationDateEle != null) {</span>
<span class="fc" id="L587">      return stringToCalendar(creationDateEle.getTextContent());</span>
    }
<span class="nc" id="L589">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;MetaCreationDateElement&lt;/code&gt; , See
   * {@odf.element meta:creation-date}.
   *
   * @param creationDate the date and time need to set. NULL will remove the element from the
   *     meta.xml.
   */
  public void setCreationDate(Calendar creationDate) {
<span class="fc" id="L600">    MetaCreationDateElement creationDateEle =</span>
<span class="fc" id="L601">        OdfElement.findFirstChildNode(MetaCreationDateElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L602" title="1 of 2 branches missed.">    if (creationDate == null) {</span>
<span class="nc bnc" id="L603" title="All 2 branches missed.">      if (creationDateEle != null) {</span>
<span class="nc" id="L604">        mOfficeMetaElement.removeChild(creationDateEle);</span>
      }
    } else {
<span class="fc bfc" id="L607" title="All 2 branches covered.">      if (creationDateEle == null) {</span>
<span class="fc" id="L608">        creationDateEle = mOfficeMetaElement.newMetaCreationDateElement();</span>
      }
<span class="fc" id="L610">      creationDateEle.setTextContent(calendarToString(creationDate));</span>
    }
<span class="fc" id="L612">  }</span>

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;DcDateElement&lt;/code&gt; , See
   * {@odf.element dc:date}.
   *
   * @return the date and time when the document was last modified;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public Calendar getDate() {
<span class="fc" id="L622">    DcDateElement dcDateEle =</span>
<span class="fc" id="L623">        OdfElement.findFirstChildNode(DcDateElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L624" title="1 of 2 branches missed.">    if (dcDateEle != null) {</span>
<span class="fc" id="L625">      return stringToCalendar(dcDateEle.getTextContent());</span>
    }
<span class="nc" id="L627">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;DcDateElement&lt;/code&gt; , See
   * {@odf.element dc:date}.
   *
   * @param date the date and time need to set. NULL will remove the element from the meta.xml.
   */
  public void setDate(Calendar date) {
<span class="fc" id="L637">    DcDateElement dcDateEle =</span>
<span class="fc" id="L638">        OdfElement.findFirstChildNode(DcDateElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L639" title="1 of 2 branches missed.">    if (date == null) {</span>
<span class="nc bnc" id="L640" title="All 2 branches missed.">      if (dcDateEle != null) {</span>
<span class="nc" id="L641">        mOfficeMetaElement.removeChild(dcDateEle);</span>
      }
    } else {
<span class="fc bfc" id="L644" title="All 2 branches covered.">      if (dcDateEle == null) {</span>
<span class="fc" id="L645">        dcDateEle = mOfficeMetaElement.newDcDateElement();</span>
      }
<span class="fc" id="L647">      dcDateEle.setTextContent(calendarToString(date));</span>
    }
<span class="fc" id="L649">  }</span>

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;MetaPrintDateElement&lt;/code&gt; , See
   * {@odf.element meta:print-date}.
   *
   * @return the date and time when the document was last printed;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public Calendar getPrintDate() {
<span class="fc" id="L659">    MetaPrintDateElement printDateEle =</span>
<span class="fc" id="L660">        OdfElement.findFirstChildNode(MetaPrintDateElement.class, mOfficeMetaElement);</span>
<span class="fc bfc" id="L661" title="All 2 branches covered.">    if (printDateEle != null) {</span>
<span class="fc" id="L662">      return stringToCalendar(printDateEle.getTextContent());</span>
    }
<span class="fc" id="L664">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;MetaPrintDateElement&lt;/code&gt; , See
   * {@odf.element meta:print-date}.
   *
   * @param printDate the date and time need to set. NULL will remove the element from the meta.xml.
   */
  public void setPrintDate(Calendar printDate) {
<span class="fc" id="L674">    MetaPrintDateElement printDateEle =</span>
<span class="fc" id="L675">        OdfElement.findFirstChildNode(MetaPrintDateElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L676" title="1 of 2 branches missed.">    if (printDate == null) {</span>
<span class="nc bnc" id="L677" title="All 2 branches missed.">      if (printDateEle != null) {</span>
<span class="nc" id="L678">        mOfficeMetaElement.removeChild(printDateEle);</span>
      }
    } else {
<span class="pc bpc" id="L681" title="1 of 2 branches missed.">      if (printDateEle == null) {</span>
<span class="fc" id="L682">        printDateEle = mOfficeMetaElement.newMetaPrintDateElement();</span>
      }
<span class="fc" id="L684">      printDateEle.setTextContent(calendarToString(printDate));</span>
    }
<span class="fc" id="L686">  }</span>

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;DcLanguageElement&lt;/code&gt; , See
   * {@odf.element dc:language}.
   *
   * @return the default language of the document;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public String getLanguage() {
<span class="fc" id="L696">    DcLanguageElement languageEle =</span>
<span class="fc" id="L697">        OdfElement.findFirstChildNode(DcLanguageElement.class, mOfficeMetaElement);</span>
<span class="fc bfc" id="L698" title="All 2 branches covered.">    if (languageEle != null) {</span>
<span class="fc" id="L699">      return languageEle.getTextContent();</span>
    }
<span class="fc" id="L701">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;DcLanguageElement&lt;/code&gt; , See
   * {@odf.element dc:language}.
   *
   * @param language the default language need to set fo the current document. NULL will remove the
   *     element from the meta.xml.
   */
  public void setLanguage(String language) {
<span class="fc" id="L712">    DcLanguageElement languageEle =</span>
<span class="fc" id="L713">        OdfElement.findFirstChildNode(DcLanguageElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L714" title="1 of 2 branches missed.">    if (language == null) {</span>
<span class="nc bnc" id="L715" title="All 2 branches missed.">      if (languageEle != null) {</span>
<span class="nc" id="L716">        mOfficeMetaElement.removeChild(languageEle);</span>
      }
    } else {
<span class="pc bpc" id="L719" title="1 of 2 branches missed.">      if (languageEle == null) {</span>
<span class="nc" id="L720">        languageEle = mOfficeMetaElement.newDcLanguageElement();</span>
      }
<span class="fc" id="L722">      languageEle.setTextContent(language);</span>
    }
<span class="fc" id="L724">  }</span>

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;MetaEditingCyclesElement&lt;/code&gt; ,
   * See {@odf.element meta:editing-cycles}.
   *
   * @return the number of times that the document has been edited;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public Integer getEditingCycles() {
<span class="fc" id="L734">    MetaEditingCyclesElement editingCyclesEle =</span>
<span class="fc" id="L735">        OdfElement.findFirstChildNode(MetaEditingCyclesElement.class, mOfficeMetaElement);</span>
<span class="fc bfc" id="L736" title="All 2 branches covered.">    if (editingCyclesEle != null) {</span>
<span class="fc" id="L737">      return Integer.valueOf(editingCyclesEle.getTextContent());</span>
    }
<span class="fc" id="L739">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;MetaEditingCyclesElement&lt;/code&gt; , See
   * {@odf.element meta:editing-cycles}.
   *
   * @param editingCycles set the specified edit times. NULL will remove the element from the
   *     meta.xml.
   */
  public void setEditingCycles(Integer editingCycles) {
<span class="fc" id="L750">    MetaEditingCyclesElement editingCyclesEle =</span>
<span class="fc" id="L751">        OdfElement.findFirstChildNode(MetaEditingCyclesElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L752" title="1 of 2 branches missed.">    if (editingCycles == null) {</span>
<span class="nc bnc" id="L753" title="All 2 branches missed.">      if (editingCyclesEle != null) {</span>
<span class="nc" id="L754">        mOfficeMetaElement.removeChild(editingCyclesEle);</span>
      }
    } else {
<span class="fc bfc" id="L757" title="All 2 branches covered.">      if (editingCyclesEle == null) {</span>
<span class="fc" id="L758">        editingCyclesEle = mOfficeMetaElement.newMetaEditingCyclesElement();</span>
      }
<span class="fc" id="L760">      editingCyclesEle.setTextContent(String.valueOf(editingCycles));</span>
    }
<span class="fc" id="L762">  }</span>

  /**
   * Receives the value of the ODFDOM element representation &lt;code&gt;MetaEditingDurationElement&lt;/code&gt;
   * , See {@odf.element meta:editing-duration}.
   *
   * @return the total time spent editing the document;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the element is not set.
   */
  public Duration getEditingDuration() {
<span class="fc" id="L772">    MetaEditingDurationElement editiingDurationEle =</span>
<span class="fc" id="L773">        OdfElement.findFirstChildNode(MetaEditingDurationElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L774" title="1 of 2 branches missed.">    if (editiingDurationEle != null) {</span>
<span class="fc" id="L775">      return Duration.valueOf(editiingDurationEle.getTextContent());</span>
    }
<span class="nc" id="L777">    return null;</span>
  }

  /**
   * Sets the value of the ODFDOM element representation &lt;code&gt;MetaEditingDurationElement&lt;/code&gt; ,
   * See {@odf.element meta:editing-duration}.
   *
   * @param editingDuration the time need to set. NULL will remove the element from the meta.xml.
   */
  public void setEditingDuration(Duration editingDuration) {
<span class="fc" id="L787">    MetaEditingDurationElement editingDurationEle =</span>
<span class="fc" id="L788">        OdfElement.findFirstChildNode(MetaEditingDurationElement.class, mOfficeMetaElement);</span>
<span class="pc bpc" id="L789" title="1 of 2 branches missed.">    if (editingDuration == null) {</span>
<span class="nc bnc" id="L790" title="All 2 branches missed.">      if (editingDurationEle != null) {</span>
<span class="nc" id="L791">        mOfficeMetaElement.removeChild(editingDurationEle);</span>
      }
    } else {
<span class="fc bfc" id="L794" title="All 2 branches covered.">      if (editingDurationEle == null) {</span>
<span class="fc" id="L795">        editingDurationEle = mOfficeMetaElement.newMetaEditingDurationElement();</span>
      }
<span class="fc" id="L797">      editingDurationEle.setTextContent(editingDuration.toString());</span>
    }
<span class="fc" id="L799">  }</span>

  /**
   * Receives the sub feature of OdfMetaDocumentStatistic.
   *
   * @return the statistics about the document which can be represented by &lt;code&gt;
   *     OdfMetaDocumentStatistic&lt;/code&gt; feature;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the feature is not exist.
   */
  public OdfMetaDocumentStatistic getDocumentStatistic() {
<span class="fc" id="L809">    MetaDocumentStatisticElement element = getDocumentStatisticElement();</span>
<span class="fc bfc" id="L810" title="All 2 branches covered.">    if (element != null) {</span>
<span class="fc" id="L811">      return new OdfMetaDocumentStatistic(element);</span>
    } else {
<span class="fc" id="L813">      return null;</span>
    }
  }

  /**
   * Receives the OdfMetaHyperlinkBehaviour feature.
   *
   * @return the default behavior of hyperlinks in the current document which can be represented by
   *     &lt;code&gt;OdfMetaHyperlinkBehaviour&lt;/code&gt; feature;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the feature is not exist.
   */
  public OdfMetaHyperlinkBehaviour getHyperlinkBehaviour() {
<span class="nc" id="L825">    MetaHyperlinkBehaviourElement element = getHyperlinkBehaviourElement();</span>
<span class="nc bnc" id="L826" title="All 2 branches missed.">    if (element != null) {</span>
<span class="nc" id="L827">      return new OdfMetaHyperlinkBehaviour(element);</span>
    } else {
<span class="nc" id="L829">      return null;</span>
    }
  }

  /**
   * Receives the OdfMetaAutoReload feature.
   *
   * @return the information whether the document is reloaded or replaced by another document after
   *     a certain period of time has elapsed.
   *     &lt;p&gt;It can be represented by &lt;code&gt;OdfMetaAutoReload&lt;/code&gt; feature;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the feature is not exist.
   */
  public OdfMetaAutoReload getAutoReload() {
<span class="nc" id="L842">    MetaAutoReloadElement element = getAutoReloadElement();</span>
<span class="nc bnc" id="L843" title="All 2 branches missed.">    if (element != null) {</span>
<span class="nc" id="L844">      return new OdfMetaAutoReload(element);</span>
    } else {
<span class="nc" id="L846">      return null;</span>
    }
  }

  /**
   * Receives the OdfMetaTemplate feature.
   *
   * @return the information specified the URL for the document that was used to create a document.
   *     &lt;p&gt;It can be represented by &lt;code&gt;OdfMetaTemplate&lt;/code&gt; feature;
   *     &lt;p&gt;&lt;code&gt;null&lt;/code&gt;, if the feature is not exist.
   */
  public OdfMetaTemplate getTemplate() {
<span class="nc" id="L858">    MetaTemplateElement element = getTemplateElement();</span>
<span class="nc bnc" id="L859" title="All 2 branches missed.">    if (element != null) {</span>
<span class="nc" id="L860">      return new OdfMetaTemplate(element);</span>
    } else {
<span class="nc" id="L862">      return null;</span>
    }
  }

  private MetaDocumentStatisticElement getDocumentStatisticElement() {
<span class="fc" id="L867">    return OdfElement.findFirstChildNode(MetaDocumentStatisticElement.class, mOfficeMetaElement);</span>
  }

  private MetaHyperlinkBehaviourElement getHyperlinkBehaviourElement() {
<span class="nc" id="L871">    return OdfElement.findFirstChildNode(MetaHyperlinkBehaviourElement.class, mOfficeMetaElement);</span>
  }

  private MetaAutoReloadElement getAutoReloadElement() {
<span class="nc" id="L875">    return OdfElement.findFirstChildNode(MetaAutoReloadElement.class, mOfficeMetaElement);</span>
  }

  private MetaTemplateElement getTemplateElement() {
<span class="nc" id="L879">    return OdfElement.findFirstChildNode(MetaTemplateElement.class, mOfficeMetaElement);</span>
  }

  /**
   * Change valid string of calendar to Calendar type.
   *
   * @param baseDate the string of a calender
   * @return the object of Calender
   */
  private Calendar stringToCalendar(String baseDate) {
    // Calendar calendar=new GregorianCalendar();
<span class="fc" id="L890">    Calendar calendar = Calendar.getInstance();</span>
<span class="fc" id="L891">    Date d1 = null;</span>
<span class="fc" id="L892">    SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss&quot;);</span>

    try {
<span class="fc" id="L895">      d1 = sdf.parse(baseDate);</span>
<span class="nc" id="L896">    } catch (Exception e) {</span>
      // invalid format or null value in meta.xml
      // d1=new Date();
<span class="fc" id="L899">    }</span>

<span class="fc" id="L901">    calendar.setTime(d1);</span>
<span class="fc" id="L902">    return calendar;</span>
  }

  /**
   * Convert a &lt;code&gt;Canlender&lt;/code&gt; object to &lt;code&gt;String&lt;/code&gt; object.
   *
   * @param calendar an instanceof &lt;code&gt;Canlender&lt;/code&gt;
   * @return the String format(yyyy-MM-dd'T'HH:mm:ss) of Calendar.
   */
  private String calendarToString(Calendar calendar) {
<span class="fc" id="L912">    return new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss&quot;).format(calendar.getTime());</span>
  }

  /**
   * @param enableAutomaticUpdate If the automatic update of metadata is enabled, metadata such as
   *     last modified data is set during saving the document. The default is &lt;code&gt;true&lt;/code&gt;,
   *     disabling the default allows to load and save a document without changing any data.
   */
  public void setAutomaticUpdate(boolean enableAutomaticUpdate) {
<span class="nc" id="L921">    mAutomaticUpdate = enableAutomaticUpdate;</span>
<span class="nc" id="L922">  }</span>

  /**
   * @return If the automatic update of metadata is enabled, metadata such as last modified data is
   *     set during saving the document. The default is &lt;code&gt;true&lt;/code&gt;, disabling the default
   *     allows to load and save a document without changing any data.
   */
  public boolean hasAutomaticUpdate() {
<span class="fc" id="L930">    return mAutomaticUpdate;</span>
  }

  @Override
  public String toString() {
<span class="nc bnc" id="L935" title="All 2 branches missed.">    if (mOfficeMetaElement != null) {</span>
<span class="nc" id="L936">      return mOfficeMetaElement.toString();</span>
    } else {
<span class="nc" id="L938">      return null;</span>
    }
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>